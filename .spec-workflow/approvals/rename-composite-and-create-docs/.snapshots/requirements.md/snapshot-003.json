{
  "id": "snapshot_1771865929509_qeeqc52xq",
  "approvalId": "approval_1771865763475_285vyzpq0",
  "approvalTitle": "Requirements v2: ディレクトリリネーム・一覧README・詳細ドキュメント作成",
  "version": 3,
  "timestamp": "2026-02-23T16:58:49.509Z",
  "trigger": "revision_requested",
  "status": "pending",
  "content": "# Requirements Document\n\n## Introduction\n\n`.github/composite/` ディレクトリを `.github/actions/` へリネームし、全ての Reusable Workflows および Composite Actions の個別 README ドキュメントを作成する。\n\nGitHub Actions エコシステムでは `actions/` ディレクトリが Composite Actions の標準的な配置先として広く採用されており、より直感的なパス名への移行と、各 Action/Workflow の利用方法ドキュメント整備を同時に行う。\n\n## Requirements\n\n### Requirement 1: ディレクトリリネーム\n\n**User Story:** リポジトリ利用者として、`.github/composite/` を `.github/actions/` にリネームしたい。パスがより直感的になり、GitHub Actions の慣習に沿ったものにするため。\n\n#### Acceptance Criteria\n\n1. WHEN `git mv` でリネームを実行 THEN `.github/composite/` が `.github/actions/` に移動し、Git 履歴が保持される\n2. WHEN リネーム後 THEN 以下の 4 つの Composite Actions がすべて `.github/actions/` 配下に存在する:\n   - `pnpm-setup/action.yml`\n   - `playwright-setup/action.yml`\n   - `slack-notify-success/action.yml`\n   - `slack-notify-failure/action.yml`\n3. WHEN リネーム後 THEN `.ls-lint.yml` のパス設定が `.github/actions` に更新される\n4. WHEN リネーム後 THEN `CLAUDE.md` 内の `.github/composite` への全参照が `.github/actions` に更新される\n5. WHEN リネーム後 THEN `README.md` 内の `.github/composite` への全参照が `.github/actions` に更新される\n6. WHEN リネーム後 THEN `docs/adr/004-composite-actions-support.md` 内の参照が更新される\n7. WHEN リネーム後 THEN `.serena/memories/` 内の参照が更新される\n8. WHEN リネーム後 THEN actionlint が `.github/actions/` を無視する（`.github/workflows/` のみスキャン対象）\n\n### Requirement 2: ディレクトリ直下の一覧 README 作成\n\n**User Story:** リポジトリ利用者として、`.github/workflows/` と `.github/actions/` の直下に一覧 README を配置したい。各 Workflow/Action の概要を一目で把握し、詳細ドキュメントへ素早くアクセスするため。\n\n#### Acceptance Criteria\n\n1. WHEN ドキュメント作成後 THEN `.github/workflows/README.md` が存在し、以下を含む:\n   - 各 Reusable Workflow（`my-*` を除く）の簡単な説明文\n   - 各 Workflow の詳細ドキュメント（`docs/*.md`）への相対リンク\n   - 内部 CI ワークフロー（`my-*`）の一覧と簡単な説明\n2. WHEN ドキュメント作成後 THEN `.github/actions/README.md` が存在し、以下を含む:\n   - 各 Composite Action の簡単な説明文\n   - 各 Action の詳細ドキュメント（`docs/*.md`）への相対リンク\n3. WHEN ルート `README.md` を参照 THEN Composite Actions / Reusable Workflows の詳細な使用方法（inputs テーブル、コード例等）が削除されている\n4. WHEN ルート `README.md` を参照 THEN `.github/workflows/README.md` と `.github/actions/README.md` への参照リンクが記載されている\n\n### Requirement 3: Reusable Workflows の詳細ドキュメント作成\n\n**User Story:** リポジトリ利用者として、各 Reusable Workflow の詳細ドキュメントを参照したい。使い方・inputs・outputs・permissions・前提条件を素早く把握するため。\n\n#### Acceptance Criteria\n\n1. WHEN ドキュメント作成後 THEN 以下のファイルが存在する:\n   - `.github/workflows/docs/actions-lint.md`\n   - `.github/workflows/docs/auto-assign-pr.md`\n   - `.github/workflows/docs/codeql-analysis.md`\n   - `.github/workflows/docs/tagpr-release.md`\n2. WHEN 各ドキュメントを参照 THEN 以下のセクションが含まれる:\n   - 概要説明\n   - トリガー（`workflow_call`）\n   - inputs（名前・型・必須/任意・デフォルト値・説明）\n   - secrets（ある場合）\n   - outputs（ある場合）\n   - 必要な permissions\n   - 前提条件\n   - 使用例（YAML コードブロック）\n3. IF 内部 CI ワークフロー（`my-*`）THEN ドキュメントは作成しない（薄いラッパーのため）\n\n### Requirement 4: Composite Actions の詳細ドキュメント作成\n\n**User Story:** リポジトリ利用者として、各 Composite Action の詳細ドキュメントを参照したい。使い方・inputs・前提条件を素早く把握するため。\n\n#### Acceptance Criteria\n\n1. WHEN ドキュメント作成後 THEN 以下のファイルが存在する:\n   - `.github/actions/docs/pnpm-setup.md`（リネーム後のパス）\n   - `.github/actions/docs/playwright-setup.md`\n   - `.github/actions/docs/slack-notify-success.md`\n   - `.github/actions/docs/slack-notify-failure.md`\n2. WHEN 各ドキュメントを参照 THEN 以下のセクションが含まれる:\n   - 概要説明\n   - inputs（名前・必須/任意・デフォルト値・説明）\n   - 前提条件\n   - 使用例（YAML コードブロック）\n3. WHEN 使用例内の参照パス THEN `.github/actions/` パスが使用される（リネーム後のパス）\n\n## Non-Functional Requirements\n\n### 後方互換性\n\n- **破壊的変更**: `.github/composite/` → `.github/actions/` のリネームは破壊的変更。外部リポジトリからの参照パスが変更される\n- **リリース対応**: メジャーバージョンアップ（v1 → v2 等）として扱うべきか、CHANGELOG に明記するかは別途判断\n\n### Git 履歴の保持\n\n- `git mv` コマンドでリネームし、ファイルの Git 履歴を維持する\n- 削除→新規作成によるリネームは禁止\n\n### ドキュメント品質\n\n- README は日本語で記述する（コードサンプル・技術用語は英語のまま）\n- 各ドキュメントは自己完結的で、単体で理解可能であること\n- `uses:` パスの例示は SHA ピン留めではなくメジャータグ（`@v1`）で記載する（簡潔さのため）\n\n### CI 整合性\n\n- リネーム後も ls-lint、ghalint、actionlint の全テストがパスすること\n- actionlint は `.github/actions/` ディレクトリを自然に無視するか確認が必要\n",
  "fileStats": {
    "size": 6238,
    "lines": 108,
    "lastModified": "2026-02-23T16:55:57.436Z"
  },
  "comments": []
}