{
  "id": "snapshot_1771862318409_sei9zukfm",
  "approvalId": "approval_1771862313025_b5a2hwawq",
  "approvalTitle": "Tasks: 5つの実装タスク（Reusable Workflow作成 + ラッパー化 + README更新）",
  "version": 2,
  "timestamp": "2026-02-23T15:58:38.409Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Tasks Document\n\n- [ ] 1. CodeQL Reusable Workflow の作成と内部 CI のラッパー化\n  - Files: `.github/workflows/codeql-analysis.yml` (新規), `.github/workflows/my-codeql.yml` (修正)\n  - `codeql-analysis.yml` を新規作成: `workflow_call` トリガー、`languages` 入力（デフォルト `'[\"actions\"]'`）、CodeQL init + analyze ステップ\n  - `my-codeql.yml` を薄いラッパーにリファクタリング: `uses: ./.github/workflows/codeql-analysis.yml` で呼び出し、ジョブレベルで `actions: read`, `contents: read`, `security-events: write` パーミッションを宣言\n  - Purpose: CodeQL セキュリティスキャンを外部リポジトリから呼び出し可能にし、内部 CI のコード重複を排除する\n  - _Leverage: 既存の `my-codeql.yml` のロジック_\n  - _Requirements: 1, 5_\n  - _Prompt: Implement the task for spec reusable-workflows-conversion, first run spec-workflow-guide to get the workflow guide then implement the task: Role: GitHub Actions Workflow Engineer specializing in reusable workflows and CI/CD | Task: Create `codeql-analysis.yml` Reusable Workflow with `workflow_call` trigger and `languages` input parameter (JSON array, default `'[\"actions\"]'`), then refactor `my-codeql.yml` to be a thin wrapper calling the reusable workflow. Reference design.md Component 1 for the exact YAML structure. All `uses:` must be pinned to full commit SHA with tag comment. | Restrictions: Do not modify any other files, use the exact same SHA pins as the existing `my-codeql.yml`, set `permissions: {}` at top level and declare job-level permissions, set `timeout-minutes` on all jobs, use `persist-credentials: false` on checkout | Success: Both files pass actionlint validation, `codeql-analysis.yml` has `workflow_call` trigger with `languages` input, `my-codeql.yml` calls `codeql-analysis.yml` with proper permissions boundary. Mark task as in-progress `[-]` before starting, log implementation with log-implementation tool after completion, then mark as complete `[x]`._\n\n- [ ] 2. tagpr Release Reusable Workflow の作成と内部 CI のラッパー化\n  - Files: `.github/workflows/tagpr-release.yml` (新規), `.github/workflows/my-release.yml` (修正)\n  - `tagpr-release.yml` を新規作成: `workflow_call` トリガー、`app-token` シークレット（required）、`tag` 出力、concurrency 制御、tagpr ジョブ + bump_major_tag ジョブ\n  - `my-release.yml` を薄いラッパーにリファクタリング: `uses: ./.github/workflows/tagpr-release.yml` で呼び出し、`app-token` シークレットを渡す、ジョブレベルで `contents: write`, `pull-requests: write` パーミッションを宣言、呼び出し元で concurrency 制御\n  - Purpose: tagpr リリース管理を外部リポジトリから呼び出し可能にし、内部 CI のコード重複を排除する\n  - _Leverage: 既存の `my-release.yml` のロジック_\n  - _Requirements: 2, 5_\n  - _Prompt: Implement the task for spec reusable-workflows-conversion, first run spec-workflow-guide to get the workflow guide then implement the task: Role: GitHub Actions Workflow Engineer specializing in release management and reusable workflows | Task: Create `tagpr-release.yml` Reusable Workflow with `workflow_call` trigger, `app-token` secret (required), `tag` output, concurrency control, and two jobs (tagpr + bump_major_tag). Then refactor `my-release.yml` to be a thin wrapper calling the reusable workflow with `app-token` secret passed through. Reference design.md Component 2 and Component 5 for the exact YAML structure. All `uses:` must be pinned to full commit SHA with tag comment. | Restrictions: Do not modify any other files, use the exact same SHA pins as the existing `my-release.yml`, set `permissions: {}` at top level, set `timeout-minutes` on all jobs, concurrency in both the reusable workflow and the wrapper, use `persist-credentials: false` on checkout | Success: Both files pass actionlint validation, `tagpr-release.yml` has `workflow_call` trigger with `app-token` secret and `tag` output, `my-release.yml` calls `tagpr-release.yml` with proper permissions and secret passing. Mark task as in-progress `[-]` before starting, log implementation with log-implementation tool after completion, then mark as complete `[x]`._\n\n- [ ] 3. Auto Assign PR Reusable Workflow の作成と内部 CI のラッパー化\n  - Files: `.github/workflows/auto-assign-pr.yml` (新規), `.github/workflows/my-setup-pr.yml` (修正)\n  - `auto-assign-pr.yml` を新規作成: `workflow_call` トリガー、入力パラメータなし、`github` コンテキスト継承を利用して PR URL と actor を取得\n  - `my-setup-pr.yml` を薄いラッパーにリファクタリング: `uses: ./.github/workflows/auto-assign-pr.yml` で呼び出し、ジョブレベルで `pull-requests: write` パーミッションを宣言\n  - Purpose: PR assignee 自動設定を外部リポジトリから呼び出し可能にし、内部 CI のコード重複を排除する\n  - _Leverage: 既存の `my-setup-pr.yml` のロジック_\n  - _Requirements: 3, 5_\n  - _Prompt: Implement the task for spec reusable-workflows-conversion, first run spec-workflow-guide to get the workflow guide then implement the task: Role: GitHub Actions Workflow Engineer specializing in reusable workflows and PR automation | Task: Create `auto-assign-pr.yml` Reusable Workflow with `workflow_call` trigger and no inputs (uses inherited `github` context for `github.event.pull_request.html_url` and `github.actor`). Then refactor `my-setup-pr.yml` to be a thin wrapper calling the reusable workflow. Reference design.md Component 3 and Component 5 for the exact YAML structure. | Restrictions: Do not modify any other files, set `permissions: {}` at top level and declare job-level `pull-requests: write`, set `timeout-minutes` on all jobs, use `github.token` instead of `secrets.GITHUB_TOKEN` in the reusable workflow, pass values through `env:` not direct template interpolation in `run:` | Success: Both files pass actionlint validation, `auto-assign-pr.yml` has `workflow_call` trigger with no inputs, `my-setup-pr.yml` calls `auto-assign-pr.yml` with proper permissions. Mark task as in-progress `[-]` before starting, log implementation with log-implementation tool after completion, then mark as complete `[x]`._\n\n- [ ] 4. Actions Lint Reusable Workflow の作成と内部 CI のラッパー化\n  - Files: `.github/workflows/actions-lint.yml` (新規), `.github/workflows/my-test.yml` (修正)\n  - `actions-lint.yml` を新規作成: `workflow_call` トリガー、`aqua-version` 入力（デフォルト `v2.56.6`）、`reviewdog-reporter` 入力（デフォルト `github-pr-review`）、actionlint + ls-lint + ghalint + zizmor ステップ\n  - `my-test.yml` を薄いラッパーにリファクタリング: `uses: ./.github/workflows/actions-lint.yml` で呼び出し、ジョブレベルで `contents: read`, `pull-requests: write` パーミッションを宣言、呼び出し元で concurrency 制御\n  - Purpose: GitHub Actions 品質ゲートを外部リポジトリから呼び出し可能にし、内部 CI のコード重複を排除する\n  - _Leverage: 既存の `my-test.yml` のロジック_\n  - _Requirements: 4, 5_\n  - _Prompt: Implement the task for spec reusable-workflows-conversion, first run spec-workflow-guide to get the workflow guide then implement the task: Role: GitHub Actions Workflow Engineer specializing in CI/CD quality gates and reusable workflows | Task: Create `actions-lint.yml` Reusable Workflow with `workflow_call` trigger, `aqua-version` input (default `v2.56.6`), and `reviewdog-reporter` input (default `github-pr-review`). Include all lint steps: actionlint (via reviewdog), ls-lint, ghalint run, ghalint run-action, and zizmor. Then refactor `my-test.yml` to be a thin wrapper calling the reusable workflow with concurrency control. Reference design.md Component 4 and Component 5 for the exact YAML structure. All `uses:` must be pinned to full commit SHA with tag comment. | Restrictions: Do not modify any other files, use the exact same SHA pins as the existing `my-test.yml`, set `permissions: {}` at top level, set `timeout-minutes` on all jobs, use `persist-credentials: false` on checkout, use `${{ inputs.aqua-version }}` and `${{ inputs.reviewdog-reporter }}` for parameterization | Success: Both files pass actionlint validation, `actions-lint.yml` has `workflow_call` trigger with both inputs, `my-test.yml` calls `actions-lint.yml` with proper permissions and concurrency. Mark task as in-progress `[-]` before starting, log implementation with log-implementation tool after completion, then mark as complete `[x]`._\n\n- [ ] 5. README.md の Reusable Workflows セクション更新\n  - File: `README.md` (修正)\n  - `### Reusable Workflows` セクションの \"Coming soon.\" を実際のワークフロー一覧に置き換える\n  - 各 Reusable Workflow について: 名前・説明、入力パラメータ / シークレット / 出力のテーブル、前提条件（該当する場合）、呼び出し例（YAML コードブロック）を記載\n  - Purpose: Reusable Workflow の利用者がドキュメントから使い方を把握できるようにする\n  - _Leverage: 既存の README.md の Composite Actions セクションのフォーマット_\n  - _Requirements: 6_\n  - _Prompt: Implement the task for spec reusable-workflows-conversion, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Technical Writer specializing in developer documentation and GitHub Actions | Task: Update README.md to replace \"Coming soon.\" in the Reusable Workflows section with documentation for all 4 reusable workflows (codeql-analysis, tagpr-release, auto-assign-pr, actions-lint). Follow the existing Composite Actions section format for consistency. Include: workflow name and description, input/secret/output tables, prerequisites if applicable, usage examples with YAML code blocks. Reference design.md for interface details and the existing Composite Actions documentation for formatting style. | Restrictions: Do not modify any other sections of README.md, maintain existing document structure, use the same table format as Composite Actions section, keep Japanese language for all documentation, include full `kryota-dev/actions/.github/workflows/xxx.yml@v1` reference paths in examples | Success: README.md has complete documentation for all 4 Reusable Workflows, formatting is consistent with Composite Actions section, all inputs/secrets/outputs are documented, usage examples are correct and complete. Mark task as in-progress `[-]` before starting, log implementation with log-implementation tool after completion, then mark as complete `[x]`._\n",
  "fileStats": {
    "size": 10809,
    "lines": 47,
    "lastModified": "2026-02-23T15:58:26.826Z"
  },
  "comments": []
}